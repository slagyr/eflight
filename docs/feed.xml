<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xml" href="http://micahmartin.com/feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.3.1">Jekyll</generator><link href="http://micahmartin.com/feed.xml" rel="self" type="application/atom+xml" /><link href="http://micahmartin.com/" rel="alternate" type="text/html" /><updated>2019-09-04T15:11:39-07:00</updated><id>http://micahmartin.com//</id><title type="html">Electric Airplane Adventures</title><subtitle>My adventures in building electric airplanes.
</subtitle><author><name>Micah Martin</name></author><entry><title type="html">eBike: Batteries</title><link href="http://micahmartin.com/2019/09/04/ebike-batteries.html" rel="alternate" type="text/html" title="eBike: Batteries" /><published>2019-09-04T00:00:00-07:00</published><updated>2019-09-04T00:00:00-07:00</updated><id>http://micahmartin.com/2019/09/04/ebike-batteries</id><content type="html" xml:base="http://micahmartin.com/2019/09/04/ebike-batteries.html">&lt;h4 id=&quot;goals&quot;&gt;Goals&lt;/h4&gt;

&lt;h5 id=&quot;speed&quot;&gt;Speed&lt;/h5&gt;

&lt;p&gt;The key to speed with electric vehicles is voltage.  The higher the voltage, the faster the motor can spin, for the most part.  Although my BMS can handle 15 cells in series (54V), I found that 14 cells in series (50.4V) propels the bike plenty fast, faster than I’m comfortable going on a bicycle.  As I mentioned before, 40+ mph is easily attainable.  50V is also a bit more manageable in terms of electrical components, so that’s the spec.&lt;/p&gt;

&lt;h5 id=&quot;acceleration--range&quot;&gt;Acceleration / Range&lt;/h5&gt;

&lt;p&gt;Amps = Torque.  The more current you can send to the motor, the more torque or acceleration you get.  Each cell in parallel adds 10A in my case.  Also, the more cells you have, the more Wh or range you get.  No reason to skimp here.  I wanted to fit as many cells as possible in the bike.&lt;/p&gt;

&lt;h5 id=&quot;learning&quot;&gt;Learning&lt;/h5&gt;

&lt;p&gt;The electric plane will have lots of packs and a central control unit will be needed to coordinate their behavior.  The networked design has to be proven.  So for this bike, although it would be simpler to have a single pack, two packs are used in parallel to tackle this next advancement.&lt;/p&gt;

&lt;h4 id=&quot;encapsulation&quot;&gt;Encapsulation&lt;/h4&gt;

&lt;p&gt;The batteries have to be a “part” of the bike.  In the first version I just plopped the batteries in the saddle bags.  Cargo capacity was limited, wires were in the way, and I had to be careful not to put metal objects in the bags else I might short the cells.  The center triangle of the bike frame seems the ideal place to put the cells.&lt;/p&gt;

&lt;h4 id=&quot;design&quot;&gt;Design&lt;/h4&gt;

&lt;p&gt;How many cells could I get in there?  To answer this I modeled the bike in Fusion 360.  Getting precise measurements of all the curves was a challenge.  By cutting foam board until it fit snugly in the frame without gaps allowed me to draw a grid and translate it into CAD.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-04/6.png&quot; alt=&quot;CAD model&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Note a few things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The cells are nestled right in the curvature of the frame to make best use of space.&lt;/li&gt;
  &lt;li&gt;They are position as low as possible.  The cells are heavy.  The low position keeps the center of mass low increasing stability.&lt;/li&gt;
  &lt;li&gt;The cell caps get 3D printed.  They hold the cells firmly in place.&lt;/li&gt;
  &lt;li&gt;Bus bars are designed to connect the cells in the desired series/parallel configuration.&lt;/li&gt;
  &lt;li&gt;Although all the cells are cased together, the bus bars are designed to connect the cells into two isolated groups.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;So how may cells?  Above we already determined that we’ll use 14 in series, and that there will be two packs.  So the total cell count has to be some multiple of 28.  It turns out that 140 cells is the most that would fit.  Two packs: 14s5p.&lt;/p&gt;

&lt;h4 id=&quot;3d-printed-caps-and-case&quot;&gt;3D Printed Caps and Case&lt;/h4&gt;

&lt;p&gt;How did I live without a 3D printer before?  What a useful tool!&lt;/p&gt;

&lt;p&gt;Here you can see the caps all printed and loaded with cells.  My printer had to manufacture them in three parts and then I glued them together.&lt;/p&gt;

&lt;p&gt;Most of the cells were rescued from the pack that fell off Justin’s scooter, hence the scratch marks from removing the previous welds.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-04/3.jpg&quot; alt=&quot;Printed Case&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;bus-bars&quot;&gt;Bus Bars&lt;/h4&gt;

&lt;p&gt;In the previous post we learned that copper, although an excellent conductor, is not ideal for bus bars.  I managed to find a supplier of pure nickel sheet metal.  It’s pricey!&lt;/p&gt;

&lt;p&gt;How do I cut the nickel into bus bars?  The machine shop wants one week to cut parts with their laser cutter.  The cost in time, money, and inconvenience is just too high.  I needed a solution where I could do fast prototyping and cut the parts on my own.  Carbon laser CNCs are affordable but they can’t cut metal.  Fiber laser CNCs cost $500k and are the size of a small bus.  So I researched CNC routers and decided to get a &lt;a href=&quot;https://carbide3d.com/shapeoko/&quot;&gt;Shapeoko&lt;/a&gt;.  These are fun!&lt;/p&gt;

&lt;p&gt;There’s a learning curve to CNC routers and it took me several attempts to get my bus bars cut properly.  It actually took a couple days of CNC-ing to get a complete set (30 pieces) cut.  If I had to do it again, I think it’d take maybe half a day knowing what I know now.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-04/2.jpg&quot; alt=&quot;CNC&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;cell-level-fuses&quot;&gt;Cell Level Fuses&lt;/h4&gt;

&lt;p&gt;The fallen pack from Justin’s scooter was good motivation to figure out cell-level fuses.  The principle here is that cells need protecting.  Not only will cell-level fuses protect the cells from overcurrent, but if a single cell shorts, it’s fuse will blow and it’s peers will not be drained.  Since my cells are rated for 10A, I wanted fuses that would blow just above 10A, like maybe 15A.&lt;/p&gt;

&lt;p&gt;Originally, I designed the fuses into my bus bars as 0.5mm legs holding onto a tab that would be welded to the cells.  However, the CNC router is a bit brutish and would rip that skinny legs out of position or cut them off entirely.  Turns out it wouldn’t have worked anyway.&lt;/p&gt;

&lt;p&gt;The 0.5mm leg width was based off calculations of nickel ampacity and some preliminary testing.  Further testing demonstrated that, although the nickle does indeed glow red hot with 15A of current, it just doesn’t melt!   Even if I increase current to 25A, it just glows hotter.  The connection remains and current continues to flow.  I redesigned the bus bars without the fuses.&lt;/p&gt;

&lt;p&gt;Based off tips from various Youtubers, I decided to try out resistor leads; the wire-ends on through-hole resistors.  It worked!  10A: nothing.  15A: they glow and melt.  Perfect!  Now, the thought of wasting resistors bugged me, so I figured out what about these wires make them work.  Turns out it’s the steel-plated solid copper wire.  Steel is a poor conductor (relatively) and it get’s hot enough to melt.&lt;/p&gt;

&lt;p&gt;I went online to buy a spool of this wire, but I guess it’s not all that common.  2 weeks for delivery was the best I could find.  I ordered it but 2 weeks is too long to wait.  Good thing I have a LOT of resistors!&lt;/p&gt;

&lt;p&gt;Welding those skinny wires to the cells was messy.  Even with some custom welding leads for the purpose, the little wires would flatten, kink, or even break sometimes.  After welding a dozen or so cells, I switched strategy.  By soldering the steel-plated wire across two nickel strips, the welding process was much more consistant.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-04/4.jpg&quot; alt=&quot;Cell Fuses&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;completed-packs&quot;&gt;Completed Packs&lt;/h4&gt;

&lt;p&gt;You can see below that I added all the sense wires, riveted on terminal plates, added connectors, cased it up and installed it in the bike.  It fits like a glove.&lt;/p&gt;

&lt;p&gt;Not visible is the kapton tape to insulate the bus bars and foam sheet to pad the cells from bumps and impacts.&lt;/p&gt;

&lt;p&gt;So far the packs work great.  The first few fuses (without nickel tips) did blow at one point, which is probabaly a good thing, so I replaced them with the improved nickel tipped version.&lt;/p&gt;

&lt;p&gt;All-in-all, these are my best packs yet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-04/1.jpg&quot; alt=&quot;Completed Pack&quot; /&gt;
&lt;img src=&quot;/eflight/img/2019-09-04/5.jpg&quot; alt=&quot;Pack in Bike&quot; /&gt;&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="eBike" /><category term="Batteries" /><summary type="html">Goals</summary></entry><entry><title type="html">Scooter Batteries</title><link href="http://micahmartin.com/2019/09/03/scooter-batteries.html" rel="alternate" type="text/html" title="Scooter Batteries" /><published>2019-09-03T00:00:00-07:00</published><updated>2019-09-03T00:00:00-07:00</updated><id>http://micahmartin.com/2019/09/03/scooter-batteries</id><content type="html" xml:base="http://micahmartin.com/2019/09/03/scooter-batteries.html">&lt;p&gt;My Brother Justin, recently purchased a used electric scooter, or more like a moped.  Unfortunately, the battery pack in the scooter died shortly after the purchase and Justin was left without transportation.  How sad.&lt;/p&gt;

&lt;p&gt;Fortunately, I had a pile of fresh 18650 cells along with my new BMS design.  So I offered to build him a new pack and in exchange he would share the data generated by the BMS/Batteries that’s I’d build.  It was a great opportunity test my equipment and learn more about electric vehicles.&lt;/p&gt;

&lt;h4 id=&quot;requirements&quot;&gt;Requirements&lt;/h4&gt;

&lt;p&gt;Since this is was meant to be a drop-in solution, I’d have to build packs with the same characteristics as his dead pack.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Voltage:  72V&lt;/li&gt;
  &lt;li&gt;Current:  130A&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;My BMS can only handle 15 cells in series.  At 3.6V each, a single BMS can only deliver 54V nominal.  That means I’d have to build two packs and wire them up in series on the scooter.  Each pack would have 10 cells in series delivering 36V.&lt;/p&gt;

&lt;p&gt;The MJ1 cells are rated for 10A max. To achieve 130A, 13 cells in parallel are needed.&lt;/p&gt;

&lt;p&gt;That’s 2 packs of 10s13p configuration.  130 cells each.  260 cells total.  That’s about 3.3kWh of energy.&lt;/p&gt;

&lt;h4 id=&quot;bus-bars&quot;&gt;Bus Bars&lt;/h4&gt;

&lt;p&gt;130A is way more than I’d every dealt with before.  The skateboard was a 30A system and I had to stack nickel strips to safely handle that meager current.  Stacking enough nickel strips to handle 130A seemed like a shoddy solution.  Instead, I headed over to the local metal supply store and purchased some 6mm thick copper sheet metal.&lt;/p&gt;

&lt;p&gt;In Fusion 360, I modeled the packs along with bus bars to connect the cells in the 10s13p configuration.  The question was, “How am I gonna cut that thick copper into the detailed CAD shapes?”&lt;/p&gt;

&lt;p&gt;I called a few machine shops and drove my copper over.  The guys at &lt;a href=&quot;https://www.steelcrestonline.com/&quot;&gt;SteelCrest&lt;/a&gt; were great!  They welcomed my in and conveniently cut my parts on the spot with their fiber laser cutter.  What a beast of a machine!  Check out the video below while my copper parts are laset cut.&lt;/p&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/357714358&quot; width=&quot;640&quot; height=&quot;360&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; fullscreen&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;Here’s the freshly cut bus bars fitting perfectly in the 3D printed cases I made.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-03/2.jpg&quot; alt=&quot;Copper Bus Bars&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;welding&quot;&gt;Welding&lt;/h4&gt;

&lt;p&gt;As it turns out, copper was not the best choice of material for the bus bars.  Why?  Because nickel doesn’t weld to copper, at least not with the spot welder I have.  Nickel is needed to connect the individual cells.&lt;/p&gt;

&lt;p&gt;I ended up plating the copper with solder.  Spot welding the nickel to the solder did work, kinda.  In the end I reinforced the spot welds with some solder welds (only on the bus bars so as not to heat the cells).  The whole process made for lots of extra work.  But it should easily handle the 130A and then some!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-03/3.jpg&quot; alt=&quot;Pack Nearly Complete&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;fallen-soldier&quot;&gt;Fallen Soldier&lt;/h4&gt;

&lt;p&gt;In the picture below, Justin and I installed new cells in his scooter.  My two packs consumed significantly less volume than the previous pack.&lt;/p&gt;

&lt;p&gt;Removing the original pack was by far the hardest part of the job.  Is was NOT meant to come out.  We had to disassemble most of the bike and use 2x4’s as crowbars to force the pack out.&lt;/p&gt;

&lt;p&gt;Meanwhile, I had placed the new packs on the luggage rack of the scooter.  That was hollow headed.  As we yanked and cranked to get the old pack out, my new packs fell to the concrete floor.  &lt;em&gt;Wince&lt;/em&gt;.  I tested the voltage and all seemed well.  It wasn’t.  A week later Justin measured the voltage again and it was low.  3.6V low.&lt;/p&gt;

&lt;p&gt;One of the cells took the brunt of the fall and shorted internally.  Not enough to explode or burn or even notice at first.  But it was enough to drain itself and the other 12 cells in it’s group.  There was little do do about it.  I built Justin another pack to replace it.&lt;/p&gt;

&lt;p&gt;This is the type of problem that cell-level fuses would have prevented.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-09-03/1.jpg&quot; alt=&quot;Justin's Scooter&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;accidental-arc-welding&quot;&gt;Accidental Arc Welding&lt;/h4&gt;

&lt;p&gt;We wired up the BMS, connected ground to the scooter’s steele chassis, and then there was just the positive lead to connect.  Justin’s fiance Ela (who is now is wife) just arrived and I remarked to them, “This is where it get’s interesting.”  In my experience, motor controllers have beefy capacitors and when you close the circuit, there’s an frightening arc of glowing electrons.&lt;/p&gt;

&lt;p&gt;At arm’s length I gingerly touched the positive lead of the controller to the corresponding lead on the BMS expecting sparks.  But nothing!  “Cool!”, I said as I relaxed, not realizing that my uninsulated connector was inches from touching the chassis.  That is until it did touch.&lt;/p&gt;

&lt;p&gt;72 volts with virtually no impedance except the steel chassis.  SPARKS EVERYWHERE!!!  Blinding light!  Crackling thunder!  I jumped back, as did Justin and Ela.  Thank goodness the cable was loose and the circuit opened once I let go of it.  The steel tubing had melted and a coin sized gouge was left behind.  Not enough structural damage to warrant repair though.&lt;/p&gt;

&lt;h4 id=&quot;results&quot;&gt;Results&lt;/h4&gt;

&lt;h5 id=&quot;the-good-news&quot;&gt;The Good News&lt;/h5&gt;

&lt;p&gt;The packs worked!  Justin was on the road again, cruising the streets of Austin.&lt;/p&gt;

&lt;p&gt;Before, Justin was lucky to get 20 miles on the scooter before a recharge was needed.   With the new packs, he estimates he could go 100 miles before needing to charge.&lt;/p&gt;

&lt;h5 id=&quot;the-bad-news&quot;&gt;The Bad News&lt;/h5&gt;

&lt;p&gt;1) The original charger that was built into the scooter didn’t work.  We had to cut some CAN wires during the replacement and these provided important communications that we were not going to reverse-engineer.  Justin also lost his built-in battery gauge because of these cut wires, but I built him a separate display to go along with the packs.&lt;/p&gt;

&lt;p&gt;2) The BMS software needed tweaking.  For various reasons, while Justin is riding, the BMSs’ safety measures kick in and cut power.  When it happens, Justin has to pull over and restart the bike, although he’s gotten pretty good at hot-starting it while on the roll.  It’s not until it happens that we can analyse the logs and see why it happens.  So the debugging process is a bit pain-staking.&lt;/p&gt;

&lt;p&gt;3) One of the BMS units got fried.  The speed controller is a black box.  We don’t know exactly how it works or why it does the things it does.  At one point it produced a voltage spike that destroyed some electronics.  A new BMS was built and we’ll have to see if we can prevent that from happening again.&lt;/p&gt;

&lt;p&gt;All-in-all, a good learning experience.&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Batteries" /><summary type="html">My Brother Justin, recently purchased a used electric scooter, or more like a moped.  Unfortunately, the battery pack in the scooter died shortly after the purchase and Justin was left without transportation.  How sad.</summary></entry><entry><title type="html">eBike: Completed</title><link href="http://micahmartin.com/2019/08/28/ebike-completed.html" rel="alternate" type="text/html" title="eBike: Completed" /><published>2019-08-28T00:00:00-07:00</published><updated>2019-08-28T00:00:00-07:00</updated><id>http://micahmartin.com/2019/08/28/ebike-completed</id><content type="html" xml:base="http://micahmartin.com/2019/08/28/ebike-completed.html">&lt;p&gt;This electric bike is finished!  I know I haven’t mentioned it before, but it is a key learning step toward building the electric plane.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-08-28/1.jpg&quot; alt=&quot;Final&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;back-story&quot;&gt;Back Story&lt;/h4&gt;

&lt;p&gt;There a lot to talk about with this bike, and I haven’t blogged any of it.  In future blogs I’ll break it down and focus on lessons learned and interesting details.&lt;/p&gt;

&lt;h4 id=&quot;ebike-features&quot;&gt;eBike Features&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.sikk.com/mens-ufo.html&quot;&gt;Sikk Fat Tire Cruise Bike&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;140 cell custom battery pack.  Two 14s5p groups working in parallel to produce 50.4V (nominal) at upto 100A&lt;/li&gt;
  &lt;li&gt;2x “FlexBMS” Battery Management Systems.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.cnqsmotor.com/en/article_read/QS%20Motor%20205%2050H%20V3%20Motor%203000W%20Electric%20High%20Power%20Bike%20Spoke%20Hub%20Motor/259.html&quot;&gt;3kW BLDC Hub Motor&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/QSMOTOR-SVMC72200-controller-3000W-4000W-Controller/dp/B07DC2987H/ref=sr_1_1&quot;&gt;3-4kW DC Controller/Inverter&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.raspberrypi.org/products/raspberry-pi-4-model-b/&quot;&gt;Raspberry PI 4&lt;/a&gt; as central control of the system&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/GeeekPi-Monitor-Resistive-Interface-Raspberry/dp/B01L6O2NEE/ref=sr_1_3&quot;&gt;5” touch screen&lt;/a&gt; for user interface&lt;/li&gt;
  &lt;li&gt;Headlights&lt;/li&gt;
  &lt;li&gt;Tail lights with brake lights&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;performance&quot;&gt;Performance&lt;/h4&gt;

&lt;h5 id=&quot;top-speed&quot;&gt;Top Speed:&lt;/h5&gt;

&lt;p&gt;Officially, 20 MPH, because that’s the law for electric bikes.  Unofficially, I may have exceeded 40 MPH.&lt;/p&gt;

&lt;h5 id=&quot;rangeendurance&quot;&gt;Range/Endurance:&lt;/h5&gt;

&lt;p&gt;I estimate it’s more than 50 miles.  The bike was completed this morning and fully charge. Today I rode about 27 miles and the batteries are at about 70% of the top of their voltage range.  Exact watt hours are challenging to calculate.&lt;/p&gt;

&lt;h5 id=&quot;manual-pedaling&quot;&gt;Manual Pedaling:&lt;/h5&gt;

&lt;p&gt;Undesirable! There have been a few unfortunate test rides where I was miles from home and without electric propulsion.  Basically the bike broke for some reason or another and I had to pedal home.  The bike is heavy!  Maybe 100lbs.  By the time I’d get home, I’d be drenched in sweat.&lt;/p&gt;

&lt;h4 id=&quot;versions&quot;&gt;Versions&lt;/h4&gt;

&lt;p&gt;The picture above is the most recent version of the eBike, but it is not the first, or second.  Below is a picture of the first version.  It was a primitive configuration with a sad BDLC motor bolted to the frame and driving the rear wheel via an awkward chain.&lt;/p&gt;

&lt;p&gt;Although version 1 was a blast to ride as you can see in the video as my good friend Skim gives it a go, the bike has improved a great deal since then.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-08-28/2.jpg&quot; alt=&quot;First Version&quot; /&gt;&lt;/p&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/356561354&quot; width=&quot;640&quot; height=&quot;360&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; fullscreen&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;</content><author><name>Micah Martin</name></author><category term="eBike" /><summary type="html">This electric bike is finished!  I know I haven’t mentioned it before, but it is a key learning step toward building the electric plane.</summary></entry><entry><title type="html">Building a BMS</title><link href="http://micahmartin.com/2019/02/08/building-a-bms.html" rel="alternate" type="text/html" title="Building a BMS" /><published>2019-02-08T00:00:00-07:00</published><updated>2019-02-08T00:00:00-07:00</updated><id>http://micahmartin.com/2019/02/08/building-a-bms</id><content type="html" xml:base="http://micahmartin.com/2019/02/08/building-a-bms.html">&lt;p&gt;To summarize the 4 months since my last post:  I’ve been educating myself.  Primarily, my time has been spent learning how to build a BMS (Battery Management Sysytem).  And there was a lot for me to learn.&lt;/p&gt;

&lt;p&gt;There were several attempts at a BMS that I’d like to share with you.&lt;/p&gt;

&lt;h4 id=&quot;1-voltage-dividers&quot;&gt;1) Voltage Dividers&lt;/h4&gt;

&lt;p&gt;With Chuck Studee’s guidance, the first problem we wanted tackle was measuring the voltage of all the cells.  Fortunately, the Arduino can sense voltage on one of its analog pins.  It’s often referred to as an ADC (Analog to Digital Converter).  It can measure up to 5V.&lt;/p&gt;

&lt;p&gt;But here’s the rub.  The pack has 10 cells in series, delivering 42V from Pack- to Pack+ when fully charged.  There’s a lead from each cell’s + terminal and if we take a multimeter to each lead, from Pack-, we’ll read the following voltages down the line: 4.2, 8.4, 12.6, 16.8, 21, 25.2, 29.4, 33.6, 37.8, 42.   Assuming we use Pack- as ground for the Arduino (otherwise we have floating voltages: bad), we can read the 4.2V from the first cell, but all the rest are too high!&lt;/p&gt;

&lt;p&gt;Well, we can use &lt;a href=&quot;https://learn.sparkfun.com/tutorials/voltage-dividers/all&quot;&gt;Voltage Dividers&lt;/a&gt; to solve that problem.  By connecting a voltage source to ground through two resistors in series, the voltage measured in between the two resistors will be divided according to this formula:  Vout = Vin * R2 / (R1 + R2).  So if we can divide our voltages by 10, then the max 42V turns into 4.2V.  Nice!  However, I didn’t have the resistors to divide by 10, so we divided by 11. R1 = 10k and R2 = 1k.&lt;/p&gt;

&lt;p&gt;Easy, right?  Well, problem is now we’ve got 11 leads from the battery pack, and not enough ADC pins on the Arduino.  Ideally we use 1 ADC pin to measure all the voltages.  So we use a multiplexer to programmatically choose which lead we want to read from.  Except we need two multiplexers so that we can read the voltage between the leads on both sides of an individual cell.  This give more precision.  So then we need a Differential Amplifier.  The outputs from that are small, so we use an Instrumental Amplifier to make the recision easier to read on the ADC pin.&lt;/p&gt;

&lt;p&gt;But there’s more:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;A Differential Amplifier is use to measure the difference between the two leads we multiplex into it.&lt;/li&gt;
  &lt;li&gt;A Instrumental Amplifier is then needed to precisely multiple the smal voltages we get from the Diff Amp.&lt;/li&gt;
  &lt;li&gt;A Linear Voltage Converter is used to feed the ADC’s reference voltage down to ~4.2V.&lt;/li&gt;
  &lt;li&gt;A Buck Converter is used to reduce the pack’s voltage to a nice 7V that the Arduino can use.&lt;/li&gt;
  &lt;li&gt;Diodes protect the cell leads&lt;/li&gt;
  &lt;li&gt;A OLED screen displays the readings&lt;/li&gt;
  &lt;li&gt;A push button Rotary Enccoder allows user inputs&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;AND… IT WORKED!  The circuit measured the voltage of each cell with relatively good accuracy.  Nice.  And then I thought “How do we balance cells now?”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-02-08/2.jpg&quot; alt=&quot;Voltage Dividers&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-flying-capacitor&quot;&gt;2) Flying Capacitor&lt;/h4&gt;

&lt;p&gt;That first circuit allowed no means to balance cells. And along the way, I read about a “Flying Capacitor” technique I wanted to try.  The principle is that you connect both leads of a single cell to a capacitor, charge the capacitor, then disconnect.  The capacitor now holds the voltage of the cell.  You can then connect the capacitor to the ADC (and ground) to read the cell’s voltage.  Or, you could connect that charged capacitor up to a power resistor and effectively drain the cell.  Or, you could charge the capacitor with a full cell, and then connect it to a less full cell.  Either way, this Flying Capacitor solves the problem of voltage measuring and balancing.&lt;/p&gt;

&lt;p&gt;The problem with this technique is that all the connections to the Flying Capacitor needs to be isolated.   If any of the components get connected to the capacitor at the same time, or if they happen to share a ground at some point, they fry.  I have a bin of burnt parts to prove it. To isolate the circuits I used a device called an Opto-Fet or Photo-MOS. It has four leads with an LED embedded in the chip.   When the LED is powered, the other two leads are connected.  Both sides of the opto-fet are totally isolated from each other.&lt;/p&gt;

&lt;p&gt;With a fleet of these opto-fets, the circuit was able to measure voltage accurately, but the rate of balancing was abysmal.  It turns out that charging and discharging a capacitor over and over is not very efficient.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-02-08/3.jpg&quot; alt=&quot;Optofets&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;3-bms-chip&quot;&gt;3) BMS Chip&lt;/h4&gt;

&lt;p&gt;The BMS problem has been solved before.  Texas Instruments offers an amazing chip that does everything I was trying to do and more in a package smaller than a dime.  The BQ76940. I ordered an evaluation kit and started playing with it.  It worked great!  So I started to build a circuit on a breadboard using this chip.  I even designed a little PCB (printed circuit board) to adapt this surface mounted chip to 2.54mm pins.&lt;/p&gt;

&lt;p&gt;My breadboard circuit was working somewhat, but only after wiring up almost all of the 44 pins on the BQ76940.  The circuit had become overwhelming for a breadboard.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-02-08/4.jpg&quot; alt=&quot;BQ76940 attempt&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;4-pcb&quot;&gt;4) PCB&lt;/h4&gt;

&lt;p&gt;Based on the forum posts, I felt like the only fool to try and wire up the BQ76940 on a breadboard.  I bit the bullet and started designing my own PCB.  This was a week long adventure and I feel good about the result.  The PCB is currently being fabricated and all the surface mounted chips are on order.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2019-02-08/1.jpg&quot; alt=&quot;PCB&quot; /&gt;&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><summary type="html">To summarize the 4 months since my last post:  I’ve been educating myself.  Primarily, my time has been spent learning how to build a BMS (Battery Management Sysytem).  And there was a lot for me to learn.</summary></entry><entry><title type="html">Cell Authenticity</title><link href="http://micahmartin.com/2018/10/16/cell-authenticity.html" rel="alternate" type="text/html" title="Cell Authenticity" /><published>2018-10-16T00:00:00-07:00</published><updated>2018-10-16T00:00:00-07:00</updated><id>http://micahmartin.com/2018/10/16/cell-authenticity</id><content type="html" xml:base="http://micahmartin.com/2018/10/16/cell-authenticity.html">&lt;p&gt;Li-ion cells, especially 18650 cells, are ripe for fraud.  They are such a commodity these days that sketchy distributors can make a handy profit by wrapping cheap low-quality cells in name brand skins and selling them for a premium.  They get creative.  Sometimes they’ll take low-end cells from a certain name brand, re-wrap them as high-end cells of the same brand and sell them.  Sometimes they’ll take an order of authentic cells and radnomly replace some of the cells with frauds.&lt;/p&gt;

&lt;p&gt;I want authentic cells going into my airplane.  So I’ve been testing the cells that I recently received.  These are LG Chem, MJ1 cells.  LG Chem publishes a product specification that describes the attributes and performance characteristics of their cells.  We can test our cells against these specifications.  I’ve been taking sample cells at random from the packing that they came in and testing them.  Here’s a sample of my data.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ID&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;case&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;out of box V&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;weight (g)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;charged voltage&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;capacity @0.5mA (mAh)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;capacity @0.2C&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;capacity @1C&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;% loss 0.2 - 1C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.139&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3783&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3410&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3330&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2.35%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.144&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3728&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3430&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.142&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3864&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.141&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3719&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.601&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.139&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3753&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3410&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3290&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.52%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.601&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;46&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.139&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3701&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3410&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.601&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;46&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.145&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3828&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.600&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;46&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.146&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3701&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;9&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.150&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3778&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3400&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3250&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.41%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;10&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.155&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3722&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3460&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;11&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.150&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3853&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;12&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.150&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3702&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;13&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.141&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3771&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3410&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3320&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2.64%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;14&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.600&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;46&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.142&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3709&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3410&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;15&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;46&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.145&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3865&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;16&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3.599&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;47&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4.147&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3696&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3310&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h5 id=&quot;appearance&quot;&gt;Appearance&lt;/h5&gt;

&lt;p&gt;MJ1 cells are wrapped in green PVC, printed with identification, and “no defects such as deep scratch, rust, discoloration or leakage”.  Not only do all the cells match the specification, but they are beautifully smooth, clean, and shiny.&lt;/p&gt;

&lt;h5 id=&quot;dimensions&quot;&gt;Dimensions&lt;/h5&gt;

&lt;p&gt;The 18650 category of cells are so named because they are 18mm in diameter and 65mm in length.  MJ1’s are actually 18.4mm in diameter though.  The specifications allow a tolerance of +0.1/-0.3mm in diameter and +-0.2mm in length.  A quick measurement of a few cells confirms the dimensions, and with all the cells lined up in the packaging, it’s easy to confirm that they are all identical.&lt;/p&gt;

&lt;h5 id=&quot;weight&quot;&gt;Weight&lt;/h5&gt;

&lt;p&gt;The specs say each cell should weight a max of 49g.  My data indicates an average of roughly 46.5g.&lt;/p&gt;

&lt;h5 id=&quot;nominal-voltage&quot;&gt;Nominal Voltage&lt;/h5&gt;

&lt;p&gt;Specs: 3.635V.  This is not something I can simply measure.  It’s more of a calculation… the average voltage during a standard discharge.  But I can measure the voltage of the cells as I pull them out of the factory packaging.  The manufacture delivers the cells at a state of charge that is ideal for shipping.  They’re not full and they’re not empty.  And they happen to be quite close to the nominal voltage.  What’s remarkable is how consistent the voltages are: 3.600V += 0.001V.  Amazing!  That indicates a high quality manufacturing process.&lt;/p&gt;

&lt;h5 id=&quot;maxmin-voltage&quot;&gt;Max/Min Voltage&lt;/h5&gt;

&lt;p&gt;The specs give a Max cell voltage of 4.2V and a Min of 2.5V.  Now, these are not so much specifications as they are instructions for the user.  One could charge a cell above 4.2V and one could discharge a cell below 2.5V. But one really shouldn’t lest they desire exploding cells (worst case scenario).&lt;/p&gt;

&lt;h5 id=&quot;capacity&quot;&gt;Capacity&lt;/h5&gt;

&lt;p&gt;Specs:  Nominal: 3500 mAh.  Minimum: 3400 mAh.  And as I understand it, manufacturers are optimistic about their “nominal” capacity.  We should expect to see capacities just above the minimum.&lt;/p&gt;

&lt;p&gt;Up to this point, testing the authenticity of the cells has been easy.  Testing capacity required considerable more effort on my behalf.&lt;/p&gt;

&lt;p&gt;I have a &lt;a href=&quot;https://www.amazon.com/Charger-Display-Intelligent-Battery-Batteries/dp/B071GKZB2G/ref=sr_1_24&quot;&gt;cheap 18650 charger&lt;/a&gt; that tests cell capacity.  As I &lt;a href=&quot;/eflight/2018/10/02/voltage-alarm.html#testing-battery-authenticity&quot;&gt;describe in the previous blog&lt;/a&gt;, the device gave results averaging around 3750 mAh.  That’s higher then the specs say because the charger only runs at 0.5A where as the specs say a standard discharge rate is 0.2C (0.68A).&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://www.amazon.com/gp/product/B07F3NHHST/ref=oh_aui_search_detailpage?ie=UTF8&amp;amp;psc=1&quot;&gt;constant current load tester&lt;/a&gt; that I got off Amazon allowed me to drain the batteries at a precise rate of my choosing.  So I gave it a shot.  See below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-16/2.jpg&quot; alt=&quot;Initial Test Setup&quot; /&gt;&lt;/p&gt;

&lt;p&gt;That test was performed on a cell that I identified as #16.  The resulting capacity at the “standard discharge rate” was 3310 mAh.  Too low! Well, after inspecting the setup, I attribute the error to the poor connections of that cell holder along with it’s skinny wires. We were experiencing voltage sag.&lt;/p&gt;

&lt;p&gt;I’ve found that spot welding Nickel strips onto the terminals of the cells gives a much better contact.  Nickel strips were welded to all the other test cells.&lt;/p&gt;

&lt;h5 id=&quot;stopping-the-capacity-test&quot;&gt;Stopping the Capacity Test&lt;/h5&gt;

&lt;p&gt;In &lt;a href=&quot;/eflight/2018/10/02/voltage-alarm.html#testing-battery-authenticity&quot;&gt;my last blog&lt;/a&gt;, I tell the whole story about how I compromised the integrity of a few cells because the load tests doesn’t stop draining the batteries, and how I solved the problem by creating a voltage alarm circuit to disconnect the load tester when the minimum voltage is detected.&lt;/p&gt;

&lt;p&gt;The next photo below shows the combined setup with the load tester and the voltage alarm circuit.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/5.jpg&quot; alt=&quot;Final Test Setup&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This setup worked great.  It protected the cells and gave accurate results which match the specifications.&lt;/p&gt;

&lt;h5 id=&quot;high-rate-discharge&quot;&gt;High Rate Discharge&lt;/h5&gt;

&lt;p&gt;The standard discharge rate yields relatively low power levels.  When these cells are installed in an airplane, they will need to deliver significantly more power.  So I ran so capacity tests at higher discharge rates.&lt;/p&gt;

&lt;p&gt;At 1C (3.4A), the load tester barely got warm.  You can see that it has a nice fan surrounded by a hugh surface area of colling fins.  That’s a repurposed CPU cooling system for computers.  My little voltage alarm circuit however has no such cooling system.  The MOSFET, through which all the battery current passes, got scolding hot.  Only a few seconds in to the first 1C test I touched the MOSFET and sizzled my finger tip, just a bit.  After installing some tiny cooling fins and placing a USB fan over the top its temperature stabilized at about 110º Celsius.&lt;/p&gt;

&lt;p&gt;I was comforted to see that the loss of capacity due to higher rates of discharge was minimal.  Only about 4% capacity loss.&lt;/p&gt;

&lt;p&gt;The specs give a max discharge rate of 10A.  For this test I didn’t bother using the voltage alarm.  And I figured I had the patience to wait for the 20 minutes it would take to discharge the cell so I didn’t need it.  I took a thermal image of the cell under test and you can see that it got pretty warm too!  Over 50º C.  Li-ion cells are not perfect power supplies.  They contain internal impedance which causes them to warn up under high loads.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-16/1.jpg&quot; alt=&quot;10A Test&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h5&gt;

&lt;p&gt;The capacity testing is time consuming with each standard rate test taking 5 hours.  So although I am continuing with random testing, I have collected enough data at this point to claim with a high level of certainty that the cells I have are authentic.  -* thumbs up *-&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><summary type="html">Li-ion cells, especially 18650 cells, are ripe for fraud.  They are such a commodity these days that sketchy distributors can make a handy profit by wrapping cheap low-quality cells in name brand skins and selling them for a premium.  They get creative.  Sometimes they’ll take low-end cells from a certain name brand, re-wrap them as high-end cells of the same brand and sell them.  Sometimes they’ll take an order of authentic cells and radnomly replace some of the cells with frauds.</summary></entry><entry><title type="html">Voltage Alarm</title><link href="http://micahmartin.com/2018/10/02/voltage-alarm.html" rel="alternate" type="text/html" title="Voltage Alarm" /><published>2018-10-02T00:00:00-07:00</published><updated>2018-10-02T00:00:00-07:00</updated><id>http://micahmartin.com/2018/10/02/voltage-alarm</id><content type="html" xml:base="http://micahmartin.com/2018/10/02/voltage-alarm.html">&lt;p&gt;It’s been nearly a month since my last post!  Why?  Well, there’s been lots to learn.&lt;/p&gt;

&lt;h4 id=&quot;testing-battery-authenticity&quot;&gt;Testing Battery Authenticity&lt;/h4&gt;

&lt;p&gt;In the &lt;a href=&quot;/eflight/2018/09/07/batteries-faraday-first.html&quot;&gt;last post&lt;/a&gt;, you saw a picture of 3000 Li-ion batteries that arrived.  Although the vendor has a good reputation and seems trust worthy, it seemed like a good idea to test the authenticity of the cells.  I’ll dive into the details of how that was accomplished in another post.  But there was one attribute of the batteries that gave me the most trouble.  Capacity.&lt;/p&gt;

&lt;p&gt;According the specs, the MJ1 cells should have a capacity of 3400 - 3500 mAh.  Conveniently, my relatively cheap 18650 charger has a “test” mode to measure the capacity of the cells.  It does this in three steps:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1 fully charge the cell
2 fully drain the cell
3 fully charge the cell again
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The process takes about a day, and it can handle 4 cells simultaneously.  Odd thing is, it gave results in the 3700 - 3900 mAh range, more than advertised!  Hmm.  Why’s that?  Well, the charger can only run the test at a rate of 500 mA.  That is, when it drains the cell, it will do so by drawing a current of 500 mA until the cell reaches the “minimum voltage”.  The interpretation of minimum voltage my be another source of error.  But anyway, the capacity of a Li-ion cell changes based on the rate at which current is drawn.  So if a large current is drawn from a cell, it will have less capacity than if a small current is drawn.&lt;/p&gt;

&lt;p&gt;MJ1 cells should yield 3400 mAh when discharged at 0.2C, or 0.68 A.  So to test these cells properly, I need to pull a constant 0.68A from them for 5 hours straight.  How does one do that?  I pondered that quastion for several days (while the cells were on the charger) and considered several options:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;* Take them to a profesional battery testing facility (Weak!)
* Build an Arduino-based circuit to do it (Don't know enough about electronics yet.  Also, time consuming.)
* Acquire battery testing hardware (Expensive.)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;While on searching on Amazon, I stumbled across &lt;a href=&quot;https://www.amazon.com/gp/product/B07F3NHHST/ref=oh_aui_search_detailpage?ie=UTF8&amp;amp;psc=1&quot;&gt;this device&lt;/a&gt; in the picture below.  It’s a constant current “load tester” device, a simple, cheap one from China.  But it does exactly was I need, for ~$40.  What a bargain!  And it works as advertised.  One minor problem is that it doesn’t know when to stop.&lt;/p&gt;

&lt;p&gt;So I set up the device in my office, plug in a cell, and set a timer for 4.5 hours.  When the timer goes off, I check on the device and it’s doing great.  The cell voltage is getting near the minimum of 2.5V and the measured capacity is at about 3100 mAh.  Awesome!  Just a few more minutes.  So I hang out in my office finding things to keep me busy… a bit too busy.  I miss the 2.5V cutoff, the device continues to drain the cell and by the time I realize it was below 2V.  Whoops.  Well, I’ll catch the next one.  Except I didn’t.  It got down to 1.5V before I realized.  (To be continued… below)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/2.jpg&quot; alt=&quot;DC Load Tester&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;electronics-apprenticeship&quot;&gt;Electronics Apprenticeship&lt;/h4&gt;

&lt;p&gt;Meanwhile, in other news…. My electrical skills are modest, at best.  I’ve dabbled with micro-controllers, hobby boards, and simple circuits.  But I had to level up on electronics in order to &lt;a href=&quot;http://micahmartin.com/onex/onex/2017/09/22/tangled.html&quot;&gt;wire the OneX&lt;/a&gt;.  To build this electric plane, I’m going to need to level up a few more times in my electrical craftsmanship.&lt;/p&gt;

&lt;p&gt;For those who know my background, it’s no surprise that I sought out a mentor for my apprenticeship in electronics.  And I was fortunate enough to find one.  &lt;a href=&quot;https://www.linkedin.com/in/charles-studee-a2ba371/&quot;&gt;Chuck Studee&lt;/a&gt; is an old friend of my father.  They worked together at &lt;a href=&quot;https://www.teradyne.com/&quot;&gt;Teredyne&lt;/a&gt; where my dad was a software guy and Chuck was a hardware guy.  As a child I remember being fascinated by Chuck’s basement laboratory filled with electrical components, soldering irons, multimeters, oscilliscope, and other gizmos and gadgets.  So I reached out to him.&lt;/p&gt;

&lt;p&gt;Chuck has been an amazing mentor.  He’s full of great stories and depths of knowledge.  One of the first things he advised me to do was equip my very own laboratory, stocked with what Chuck calls “jelly bean” parts; resistors, capacitors, transistors, etc. that are commonly used. See the picture below.  Being so well equipped has already proved extremely valuable.&lt;/p&gt;

&lt;p&gt;I have a backlog of learning experiments to run.  Chuck will think of interesting circuits, like Darlington transistor configuration, or an opamp constant current source. We’ll talk about them over the phone and then Chuck will email me a little circuit to wire up and play with.  I find these experiments essential for learning.  They’re full of surprises.  I mean, I’ve recently read electronics books and I’m familiar with the theory, but each time I play with the hands-on examples I learn something new.  Sometimes they perplex me so call Chuck and he walks me through it.&lt;/p&gt;

&lt;p&gt;With my newly acquired skills, it was time to build a real circuit…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/3.jpg&quot; alt=&quot;Electronics Lab&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;circuit-diagrams&quot;&gt;Circuit Diagrams&lt;/h4&gt;

&lt;p&gt;Back to testing the cell capacity…  Draining Li-ion cells below their minimum voltage is not good.  Bad things happen.  Fire, explosions…  So continuing to use the constant current device is not an option.  Not unless I’m alerted when the battery is empty (at 2.5V).  Hmm… I could build a circuit like that. Use an Arduino to track the cell voltage and sound a piezo buzzer when it gets down to 2.5V.  Or better yet, in addition to a buzzer, this “Voltage Alarm” could open the circuit to the load tester and stop the current flow.  Perfect!&lt;/p&gt;

&lt;p&gt;I sketch a circuit that includes an Arduino Nano, a passive piezo buzzer, and a FET (field effect transistor) to open/close the load circuit.  And to make the voltage alarm more flexible, and for the fun of it, I include a user interface made of a 16x2 LCD screen and a rotary encoder, the push button kind.  I send the picture below to Chuck.  He sends back a similar sketch of a circuit, but one that might actually work.&lt;/p&gt;

&lt;p&gt;While I’m writing about circuit diagrams, I’ll point out the computer generated schematic (second image below) which is the final representation of the Voltage Alarm.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/6.jpg&quot; alt=&quot;Circuit Sketch&quot; /&gt; 
&lt;img src=&quot;/eflight/img/2018-10-02/7.png&quot; alt=&quot;Final Circuit&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;arduino-coding&quot;&gt;Arduino Coding&lt;/h4&gt;

&lt;p&gt;Rather than wire things up, I retreated into my comfort zone; code.  C++ code in fact.  It ain’t no Clojure or  Ruby, but it’s what the Arduino takes; C++.  I discovered &lt;a href=&quot;https://github.com/google/googletest&quot;&gt;Google Test&lt;/a&gt;, a C++ unit testing framework, and started whipping out code.  I may have gotten carried away, building a whole menu structure with configurable settings.  The LCD screen can display two rows of text 16 characters wide.  And the rotary encoder allows you to navigate the menus by spinning clockwise to scroll down, counter-clockwise to scroll up, and puth-button to select an item.  Pretty sweet!&lt;/p&gt;

&lt;p&gt;Over about 2 weeks, the circuit came together.  Bit by bit, I’d piece together the hardware to make sure the code would run.  At one point, everything stopped working.  On power up, things would start ok, but then the LCD would display garbage and the Arduino would freeze or reboot over and over.  Nothing would fix it except commenting out code that had previously been working fine.  Wierd!  Turns out I was running out of memory.  The Nano has 2k of SRAM, stack and heap combined.  My style of programming was apparently quite wasteful with memory.  I switched gears and rafactored the code to be very conservative.  By the time the entire program was implemented, I had 308 bytes to spare!&lt;/p&gt;

&lt;p&gt;Below is the completed circuit prototype on a couple breadboards.  It worked, mostly.  The connections on the breadboards are not great and the jumper wires and alligator clips make for flimsy circuits.  There were hugh voltage sags between the battery and the load tester with jumpy readings.  Nothing a little solder can’t fix, I hoped.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/4.jpg&quot; alt=&quot;Breadboard&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;final-wiring&quot;&gt;Final Wiring&lt;/h4&gt;

&lt;p&gt;With the prototype circuit working, I documented the circuit in the schematic above.  Choosing the right software was a process of it’s own.  Research led me to believe that &lt;a href=&quot;https://www.autodesk.com/products/eagle/overview&quot;&gt;Eagle&lt;/a&gt;, owned by AutoDesk, is the standard.  That was good news because I really like AutoDesk’s Fusion 360 CAD tool.  I’ve been using Eagle but it’s a bit heavy and seams geared toward final printed circuit board design.  I also tried &lt;a href=&quot;https://www.circuitlab.com/&quot;&gt;CircuitLab&lt;/a&gt; (it was quick to demand money) and few other tools.  For now I’ve settled on &lt;a href=&quot;https://easyeda.com/&quot;&gt;EasyEDA&lt;/a&gt;.  It’s easy to use, has all the feature I should need, and it’s free!&lt;/p&gt;

&lt;p&gt;Wiring and soldering the final circuit of the Voltage Alarm was a 20 hour project.  More time than I imagined.  Of course I made newbie mistakes and had to redo several parts.  And it didn’t work the first time, or second time.  But after debugging the all the wiring problems, it did work.  The voltage sag was gone.  I could finally test the battery cells without draining them too much.&lt;/p&gt;

&lt;p&gt;It only took three weeks to get to that point!  &lt;em&gt;-sigh of lamentation-&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The first picture below is a running test with my Voltage Alarm hooked up to the battery and the constant current load tester.  The second is a close up of the Voltage Alarm in the “ALM” (alarm) state. Finally, there’s a video showing how it works at the bottom.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-10-02/5.jpg&quot; alt=&quot;Test Setup&quot; /&gt;
&lt;img src=&quot;/eflight/img/2018-10-02/1.jpg&quot; alt=&quot;Completed Circuit&quot; /&gt;&lt;/p&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/292998666&quot; width=&quot;640&quot; height=&quot;360&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><summary type="html">It’s been nearly a month since my last post!  Why?  Well, there’s been lots to learn.</summary></entry><entry><title type="html">Batteries &amp;amp; Faraday First</title><link href="http://micahmartin.com/2018/09/07/batteries-faraday-first.html" rel="alternate" type="text/html" title="Batteries &amp; Faraday First" /><published>2018-09-07T00:00:00-07:00</published><updated>2018-09-07T00:00:00-07:00</updated><id>http://micahmartin.com/2018/09/07/batteries--faraday-first</id><content type="html" xml:base="http://micahmartin.com/2018/09/07/batteries-faraday-first.html">&lt;h4 id=&quot;batteries&quot;&gt;Batteries!&lt;/h4&gt;

&lt;p&gt;They arrived today.  3,000 LG Chem MJ1 cells.  These are 18650 Li-ion cells with a nominal voltage of 3.6 V and a capacity of 3.5 Ah.  That’s 12.6 Wh in each cell. 37.8 kWh in the whole pile of batteries.  Sound like a lot?  Well it’s about the same amount energy as a gallon of gasoline.  A gallon of gas weights about 6 lbs, whereas that pile of batteries weights 330 lbs (150 kg).  And it’s not even enough batteries.  I’ll likely need to get about 2,000 more.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-09-07/1.jpg&quot; alt=&quot;3000 MJ1s&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;detructive-battery-testing&quot;&gt;Detructive Battery Testing&lt;/h4&gt;

&lt;p&gt;Next week I plan to start destroying some cells.  I’ll over charge them, drain them too quickly, heat them too much, whatever it takes to make them explode, melt down, of fail in some way.&lt;/p&gt;

&lt;p&gt;Why would I be so wasteful and destructive?&lt;/p&gt;

&lt;p&gt;For the most part, these cells are pretty safe.  The chance of a single cell failing catastrophically under normal use is quite low.  In pack of ~5,000 cells, the chance is 5,000 more likely.  For the sake of safety I need to assume that cells will fail during flight.  The battery packs I build need to accommodate failures without damaging their function and more importantly, preventing a chain reaction.  So I need a solid understanding of how these cells fail and what options I have to control the failures.&lt;/p&gt;

&lt;h4 id=&quot;faraday-first&quot;&gt;Faraday First&lt;/h4&gt;

&lt;p&gt;A couple weeks ago I finished modeling and printing &lt;a href=&quot;https://www.howfliesthealbatross.com/&quot;&gt;Phil’s (How Flies the Albatross)&lt;/a&gt; Faraday First plane. With this design Phil was considering high speed passenger transportation.  It’s got a blended wing shape, but more interesting are the control surfaces.  They are totally unconventional.  On the outer edge of the wings are what look like winglets, but they are rudder-like control surfaces.  They rotate about their vertical axis inducing roll.  There are no ailerons!  The ventral fin on the bottom also rotates, yielding yaw.  And come to think of it, I’m not sure what his plan is for pitch control.  Hmm.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-09-07/2.jpg&quot; alt=&quot;FaradayFirst Flight&quot; /&gt;
&lt;img src=&quot;/eflight/img/2018-09-07/3.jpg&quot; alt=&quot;Phil's Planes&quot; /&gt;&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><category term="3D Printing" /><summary type="html">Batteries!</summary></entry><entry><title type="html">Coulomb Keeper</title><link href="http://micahmartin.com/2018/08/14/coulomb-keeper.html" rel="alternate" type="text/html" title="Coulomb Keeper" /><published>2018-08-14T00:00:00-07:00</published><updated>2018-08-14T00:00:00-07:00</updated><id>http://micahmartin.com/2018/08/14/coulomb-keeper</id><content type="html" xml:base="http://micahmartin.com/2018/08/14/coulomb-keeper.html">&lt;p&gt;I need to tell you all about 3D printing flying R/C planes, and I will.  It’s really cool!  But this blog is about a different type of 3D printed airplane.  It’s called the Coulomb Keeper.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-08-14/1.jpg&quot; alt=&quot;Flying&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While at the &lt;a href=&quot;http://sustainableaviation.org/sas2018/&quot;&gt;Sustainable Aviation Symposium&lt;/a&gt;, I introduced myself to &lt;a href=&quot;https://www.howfliesthealbatross.com/&quot;&gt;Phil from How Flies The Albatross&lt;/a&gt;.  He had given a fascinating talk about his ideas for electric flight and briefly presented two concept planes.  The Coulomb Keeper is the smaller, more general aviation model. The larger, jet like, model is called the Faraday First and perhaps I’ll blog about that one later.&lt;/p&gt;

&lt;p&gt;So I asked Phil if he’d be willing to share he aircraft designs with me so that I could print them and see how they fly.  He agreed!  In fact he asked if I could print him a smaller “draft” model and take pictures for his next presentation.  What he sent me were Blender files.  &lt;a href=&quot;https://www.blender.org/&quot;&gt;Blender is a 3D modeling tool&lt;/a&gt; that is used for amination, games, and a variety of things, but I had never used it before.  Fortunately it’s open source, and free!  Unfortunately, a yak must be shaved to get from Blender .BLEND files to 3D printable .GCODE files.  Allow me to describe the yak.&lt;/p&gt;

&lt;h5 id=&quot;blend---obj&quot;&gt;.BLEND -&amp;gt; .OBJ&lt;/h5&gt;
&lt;p&gt;My tool of choice for 3D modeling is &lt;a href=&quot;https://www.autodesk.com/products/fusion-360/overview&quot;&gt;Fusion 360&lt;/a&gt;, which is aimed more at engineering modeling.  I downloaded Blender, installed it, opened the .BLEND files, and exported them to .OBJ files.  Now, you’ll see below that I’ll eventually need .STL files and Blender can export these.  But the model needs modification before we can print it.  Why?  Mostly because it’s too big.  My printer (&lt;a href=&quot;https://craftunique.com/category/craftbot-2&quot;&gt;a Craftunique CraftBot 2&lt;/a&gt;) has a print volume of about 8 inches cubed.  Whereas the printed result has a wingspan of over 2.5 feet.  So I need to work with the model in Fusion 360.&lt;/p&gt;

&lt;h5 id=&quot;obj---t-splines&quot;&gt;.OBJ -&amp;gt; T-Splines&lt;/h5&gt;
&lt;p&gt;The Coulomb Keeper .OBJ file imports easily into Fusion 360 as “Mesh”.  Meshes consist of a lot quadrilaterals or triangles that model the outer skins of an object.  However, they are inconvenient for typical manipulations that we’d like to perform, and they are not solid, which is we want.  Fusion 360 has a feature to “Convert Quad-Mesh to T-spline”.  This breaks up the conglomerate Mesh into all the composing pieces (propeller blades, wings, wheels, etc.) in T-Spline format, about 30 of them.  What’s a T-Spline?  Well, a &lt;a href=&quot;https://en.wikipedia.org/wiki/T-spline&quot;&gt;T-Spline is like a complicated Mesh&lt;/a&gt;, and a patented specialty of Fusion 360.&lt;/p&gt;

&lt;h5 id=&quot;t-splines---surface-bodies&quot;&gt;T-Splines -&amp;gt; Surface Bodies&lt;/h5&gt;
&lt;p&gt;T-Splines, although powerful, are not what we want.  We want Solid Bodies.  Fusion 360 can “Convert T-Spline to BRep” which get’s us close.  A &lt;a href=&quot;https://en.wikipedia.org/wiki/Boundary_representation&quot;&gt;BRep, Bourdary Representation&lt;/a&gt;, or Surface Body, is nice smooth model of the skin of the object, which gets us close to Solids.  But, only a fraction of the T-Splines successfully convert into BReps.  Fusion 360 just can’t deal with the geometry of some of the parts.  With some clever tweaking it’s usually possible to successfully convert to Surface Bodies without compromising too much on the exact shape of the model.&lt;/p&gt;

&lt;h5 id=&quot;surface-bodies---solid-bodies&quot;&gt;Surface Bodies -&amp;gt; Solid Bodies&lt;/h5&gt;
&lt;p&gt;To convert a Surface Body to a Solid Body, you simply patch up all the holes and they magically convert.  Of course it’s never that easy.  Some surfaces have unpluggable holes for whatever reason.  Fusion 360 just chokes on some geometries.  Progress requires that some parts get re-modeled from scratch.  At the end, we have Solid Bodies.&lt;/p&gt;

&lt;p&gt;Hurray!  Now we can work with the model.  Mostly that means combining all the Solid Bodies and cutting them into pieces that will print in the 3D printer; flat bottom surfaces, no overhangs, &amp;lt;45° horizontal angles, and all dimensions less than 200mm.  See the Solid Body model below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-08-14/3.jpg&quot; alt=&quot;CAD&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;solid-body---stl&quot;&gt;Solid Body -&amp;gt; .STL&lt;/h5&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/STL_(file_format)&quot;&gt;.STL files (Standard Triangle Language)&lt;/a&gt; are the universal format for 3D printable models. Fusion 360 embraces 3D printing and makes it easy to export models as .STL files.  I tend to export each of the Solid Bodies individually.  Soon I will have to learn how use Fusion 360’s STL features to combines parts in one file and better prepare them for printing.&lt;/p&gt;

&lt;h5 id=&quot;stl---gcode&quot;&gt;.STL -&amp;gt; .GCODE&lt;/h5&gt;
&lt;p&gt;CNC (Computer Numerical Control) machines often consume &lt;a href=&quot;https://en.wikipedia.org/wiki/G-code&quot;&gt;GCode files&lt;/a&gt; which contain detailed commands telling the machines exactly what to do.  That’s true for 3D printers.  Generating GCode from STL is non-trivial and requires the use of a Slicer.  Slicer software allows you to control many aspects of a print job; layer thickness, speed, infill, supporting structures, etc.  There are many open source, free Slicers out there, but I use &lt;a href=&quot;https://www.simplify3d.com/&quot;&gt;Simplify3D&lt;/a&gt; because it was recommended and I find it simple and effective.  There’a bit of art involved in good Slicing, but these parts were not particularly challenging.&lt;/p&gt;

&lt;h5 id=&quot;gcode---printed-model&quot;&gt;.GCODE -&amp;gt; Printed Model&lt;/h5&gt;

&lt;p&gt;Fast forward through roughly 18 hours of printing and a little bit of time trimming, sanding, and gluing the parts together.  We now have a Coulomb Keeper, in the flesh,… or plastic.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-08-14/2.jpg&quot; alt=&quot;Grounded&quot; /&gt;
&lt;img src=&quot;/eflight/img/2018-08-14/4.jpg&quot; alt=&quot;Tristan and Micah&quot; /&gt;&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="3D Printing" /><summary type="html">I need to tell you all about 3D printing flying R/C planes, and I will.  It’s really cool!  But this blog is about a different type of 3D printed airplane.  It’s called the Coulomb Keeper.</summary></entry><entry><title type="html">Welding Batteries</title><link href="http://micahmartin.com/2018/08/06/welding-batteries.html" rel="alternate" type="text/html" title="Welding Batteries" /><published>2018-08-06T00:00:00-07:00</published><updated>2018-08-06T00:00:00-07:00</updated><id>http://micahmartin.com/2018/08/06/welding-batteries</id><content type="html" xml:base="http://micahmartin.com/2018/08/06/welding-batteries.html">&lt;p&gt;In the &lt;a href=&quot;/eflight/2018/07/18/electric-skateboard.html&quot;&gt;previous post on the electric skateboard&lt;/a&gt; I alluded to a better way to connect batteries.  The steel springs and screw I had originally used led to voltage sag because of the relatively high resistance of steel.  A better solution is to use Nickel strips and spot weld them to the battery terminals.&lt;/p&gt;

&lt;p&gt;Here’s a picture of new welded battery pack for the skateboard.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-08-06/1.jpg&quot; alt=&quot;New Battery Pack&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;spot-welding&quot;&gt;Spot Welding&lt;/h4&gt;

&lt;p&gt;A spot welder works by releasing a pulse (or two) of high current through two leads.  The leads should be touching the material, let’s assume Nickel, to be welded.  The high current heats up the Nickel beyond it’s melting point and once cooled, the metal surfaces are welded together.&lt;/p&gt;

&lt;p&gt;Most spot welders actually release two pulses of current.  The first is a short pulse that will soften the Nickel and burn any contaminants.  Afterwards the leads make much better contact with the Nickel.  This makes the second, longer pulse more effective.  It’s the second pulse that causes the welding.&lt;/p&gt;

&lt;h4 id=&quot;nickel&quot;&gt;Nickel&lt;/h4&gt;

&lt;p&gt;Pure Nickel is a great material for spot welding batteries.  1) Nickel is 12 times more conductive than stainless steel.  It can carry the high current loads without significant voltage sag.  2) Nickel is 4 times more resistive (25% the conductivity) of copper.  Now, Copper, Silver, Gold, and Aluminum are all better conductors than Nickel, but when it comes to spot welding, we need one metal to melt.  If we tried spot welding copper strips, the copper leads would end up welded to the copper strips.  Not good!  Nickel has enough resistance to soak up some current and heat to it’s melting point first.&lt;/p&gt;

&lt;p&gt;For the purpose of building battery packs, I purchased a big roll of 8mm x 0.15mm Nickel tape.  With these dimensions, one strip can safely carry 5 Amps.  But the pack needs to deliver 20 Amps.  So in many places there are multiple strips of Nickle overlapping and welded together.  The combined strips are sufficient to carry the 20A load.&lt;/p&gt;

&lt;h4 id=&quot;arduino-spot-welder&quot;&gt;Arduino Spot Welder&lt;/h4&gt;

&lt;p&gt;Try shopping for a spot welder online.  You’ll find industrial welders, the kind used on cars.  And you’ll find welders made in China with chinese labels.  I was pleased to see that there’s a &lt;a href=&quot;https://www.instructables.com/id/DIY-Arduino-Battery-Spot-Welder/&quot;&gt;DYI welder built using an Ardiuno&lt;/a&gt;.  Not only does tham mean I can download the source code and play with it, but this welder has hand-held leads and a pedal to trigger the pulses.&lt;/p&gt;

&lt;p&gt;I shared a few emails with &lt;a href=&quot;https://malectrics.eu/&quot;&gt;Marc from Malectrics&lt;/a&gt; and I gotta say, he’s a good guy.  Very helpful!&lt;/p&gt;

&lt;p&gt;I hooked up the Arduino welder to my backup EarthX battery for the OneX, and it worked awesome!  Love it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-08-06/2.jpg&quot; alt=&quot;Sopt Welder&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;why-not-solder&quot;&gt;Why Not Solder?&lt;/h4&gt;

&lt;p&gt;It would be tempting to just solder copper wire between the batteries.  If you’re like me, you already have a soldering iron and plenty of copper wire.  Whereas, spot welders are not so common and are rather pricey.&lt;/p&gt;

&lt;p&gt;With Lithium batteries, heat is the enemy.  It’s always fun to watch &lt;a href=&quot;https://www.youtube.com/results?search_query=Li-ion+Thermal+runaway&quot;&gt;Youtube videos of thermal runaway of Li-ion cells&lt;/a&gt;.  Cells reaching temperatures higher than 265°F are susceptible to thermal runaway.  Solder melts at 370°F and soldering irons often reach 600°F or more.  Li-ion batteries do indeed absorb the heat of the solder and the soldering iron and the internal chemicals almost certainly reach 265°.&lt;/p&gt;

&lt;p&gt;Now, brand name 18650 batteries are well made and will not likely explode when you solder them.  But there’s a risk.  And certainly, the heat will damage the cells.  They’ll have less capacity and a shorter life.&lt;/p&gt;

&lt;p&gt;Spot welding get’s hot too.  But the heated area is so small and the duration is so short, the head barely penetrates into the cell.  Here’s a &lt;a href=&quot;https://www.youtube.com/watch?v=byvr-dwwao4&quot;&gt;video comparing soldering and spot welding with a thermal camera&lt;/a&gt;.&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><summary type="html">In the previous post on the electric skateboard I alluded to a better way to connect batteries.  The steel springs and screw I had originally used led to voltage sag because of the relatively high resistance of steel.  A better solution is to use Nickel strips and spot weld them to the battery terminals.</summary></entry><entry><title type="html">Electric Skateboard</title><link href="http://micahmartin.com/2018/07/18/electric-skateboard.html" rel="alternate" type="text/html" title="Electric Skateboard" /><published>2018-07-18T00:00:00-07:00</published><updated>2018-07-18T00:00:00-07:00</updated><id>http://micahmartin.com/2018/07/18/electric-skateboard</id><content type="html" xml:base="http://micahmartin.com/2018/07/18/electric-skateboard.html">&lt;p&gt;An electric plane is a large project.  I need to start small, so I built an electric skateboard.  It has all the same basic components as the plane will: motor, controller, and battery. To get familiar with that trio, this is an ideal project.  Below is shot of the finished “esk8”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-07-18/1.jpg&quot; alt=&quot;Finished Board Top&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;getting-started&quot;&gt;Getting Started&lt;/h4&gt;

&lt;p&gt;The LA gang of 8th Light introduced me to esk8s with their Boosted Boards.  I loved them!  My son Luka and I had talked about building one for a couple years.  This was the time to do it.&lt;/p&gt;

&lt;p&gt;While watching YouTube videos on the topic, I found &lt;a href=&quot;https://www.youtube.com/watch?v=1D90heZ8z4s&quot;&gt;this video by a guy named Micah Toll&lt;/a&gt;.  (Great name!)  Not only did Micah do a great job on the video, he has &lt;a href=&quot;http://www.electricskateboardparts.com/&quot;&gt;a site where he sells electric skateboard kits&lt;/a&gt;. I bought one.  However, I did not buy the battery because I wanted the experience of building the battery pack myself.  And it turns out &lt;a href=&quot;https://www.amazon.com/DIY-Lithium-Batteries-Build-Battery/dp/0989906701/ref=sr_1_1?ie=UTF8&amp;amp;qid=1531974163&amp;amp;sr=8-1&amp;amp;keywords=Micah+Toll&quot;&gt;Micah wrote a book on how to do that&lt;/a&gt;.  I bought the book too and read it one morning.&lt;/p&gt;

&lt;p&gt;Buying lithium batteries is tricky.  They’re expensive, they’re in high demand and there’s a good deal of fraud out there.  This project only required a handful so I went to my trusted source, Amazon, and purchased 20 Samsung 25R 18650 cells.  These cells have a medium capacity of 2500 mAh and a really nice discharge rate of 20A.  With a 10s2p (10 cells in series, 2 in parallel) the pack will yield 36 nominal volts at 40 amps max.&lt;/p&gt;

&lt;p&gt;The the video shows off those nifty &lt;a href=&quot;https://vruzend.com/&quot;&gt;Vrusend battery pack builders&lt;/a&gt;.  Unfortunately they were sold out.  No big deal, I can design something similar in CAD and 3D print them into existance.  The picture below shows the results.  While they were printing I ran to Ace to buy the springs, bolts, and, nuts you see there.  The metal strips are made from left over aluminum sheet from the OneX.  The battery pack came together nicely.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-07-18/2.jpg&quot; alt=&quot;First Battery Holders&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;things-go-wrong&quot;&gt;Things Go Wrong&lt;/h4&gt;

&lt;p&gt;Lithium batteries can be easily damaged if they’re overcharged or drained too much.  Good battery chargers will charge the cells to the perfect voltage, but how do you make sure not to drain them too much?  Even worse, this battery pack has 20 cells of which some may charge or discharge faster than others.  To manage this complexity most battery packs include a circuit board called a BMS, Battery Management System.  It will disconnect cells before they under/over charge and make sure all the cells have a balanced charge.&lt;/p&gt;

&lt;p&gt;The BMS I got was about $20 off Amazon.  That’s cheap as far as BMS’s go.  You get what you pay for.  When I connected it, it appeared not to work.  So I ordered another.  It did work.  I charged the pack and all the cells showed a nice high voltage.&lt;/p&gt;

&lt;p&gt;Assembling the rest of the skateboard kit was uneventful.  So with the battery charged I plugged it into the dual motor controllers and they came to life with a beep and solid red LED.  On the handheld remote I pushed on the throttle and the wheels spun!  Awesome!  It was time to ride.  With some zip-ties I strapped everything to the board, put it on the ground, stepped right on and throttled up.  The board moved, but only a bit, and then did nothing.  I unplugged the battery, replugged it, tried again, and the same thing happened.&lt;/p&gt;

&lt;p&gt;There was a major problem that I attributed to bad controllers.  I emailed Micah.  He had me run some tests and concluded that the BMS was cutting off the battery due to low voltage.  But how could that be?  The lithium cells were brand new and I measured really high voltage coming out of the pack.  Well, Micah pointed out to me that the springs and bolts in my pack were the culprit, causing “voltage sag”.  They are made of steel, and steel has a relatively poor conductivity.  With me on the board it has to pull a significant amount of current to spin the wheels.  Ohms Laws, V=IR.  The voltage drop is proportional to the current and with the high resistance of steel, the voltage drops enough to make the BMS think the batteries have been drained too much.  It cuts out.&lt;/p&gt;

&lt;h4 id=&quot;rebuild&quot;&gt;Rebuild&lt;/h4&gt;

&lt;p&gt;Over time I rebuild the battery pack using more industrial techniques of which I’ll discuss in a later blog.  It’s cool.  And I added 10 more lithium cells to the pack because I had the space and more range is always nice.&lt;/p&gt;

&lt;p&gt;The BMS’s caused more problems but I can’t really explain it.  They are like black boxes, giving no indication of what they’re doing, or not doing.  And I may have fried one while I was disassembling the first battery pack.  It made a big spark when it shorted against a sharp piece of solder poking through the positive battery terminal insulation.  Eventually I got the original BMS working.  Don’t know how exactly.&lt;/p&gt;

&lt;p&gt;Below you can see all the guts of the board.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-07-18/3.jpg&quot; alt=&quot;Internals&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;finished-board&quot;&gt;Finished Board&lt;/h4&gt;

&lt;p&gt;The final step was to create a protective cover for all the electronics.  I whipped up a simple design in Fusion 360 and printed it over 2 days.  There are 5 attach points to mount the cover to the board, and there are 3 holes for the charging plug, on/off button, and battery status screen.  I installed it today and it fit perfectly.&lt;/p&gt;

&lt;p&gt;There was nothing left to do except ride it!  I cruised around the neighborhood for maybe a mile or more, averaging 10 mph perhaps.  Gee, what fun it was!  The board performed like a champ and had 85% battery charge remaining.  However, it did get hot.  The rear trucks, attached to the motorized wheel, must have been almost 200°F.  Of course, if you carried me for a mile at 10mph on a 110°F day in Pheonix, you’d be hot too.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/eflight/img/2018-07-18/4.jpg&quot; alt=&quot;Finished Bottom&quot; /&gt;&lt;/p&gt;</content><author><name>Micah Martin</name></author><category term="Battery" /><summary type="html">An electric plane is a large project.  I need to start small, so I built an electric skateboard.  It has all the same basic components as the plane will: motor, controller, and battery. To get familiar with that trio, this is an ideal project.  Below is shot of the finished “esk8”.</summary></entry></feed>
